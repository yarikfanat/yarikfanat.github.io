var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MessageBox=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showBox:!1,boxPos:{}},n.class_box="msg_box",n.isCloseState=null,n.isDownMouse=!1,n.delta={},n.AnimationEnd=n.AnimationEnd.bind(n),n.ClickButton=n.ClickButton.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n}return _inherits(t,React.Component),_createClass(t,[{key:"AnimationEnd",value:function(){this.class_box="msg_box",this.isCloseState&&this.props.render(this.isCloseState)}},{key:"componentDidMount",value:function(){void 0!==this.props.effect&&(this.class_box+=" animate__animated animate__"+this.props.effect),this.setState({showBox:!0})}},{key:"ClickButton",value:function(e){void 0!==this.props.effectOut?(this.isCloseState=e.target.textContent,this.class_box+=" animate__animated animate__"+this.props.effectOut,this.setState({showBox:!0})):this.props.render(e.target.textContent)}},{key:"handleMouseDown",value:function(e){var t=this.msgBox.getBoundingClientRect();this.delta={left:e.clientX-t.left,top:e.clientY-t.top},this.isDownMouse=!0}},{key:"handleMouseUp",value:function(){this.isDownMouse=!1}},{key:"handleMouseMove",value:function(e){if(this.isDownMouse){var t=e.clientX-this.delta.left,n=e.clientY-this.delta.top;this.class_box="msg_box1",this.setState({boxPos:{left:t,top:n}})}}},{key:"render",value:function(){var e,t,n=this;return e="confirm"==this.props.type?React.createElement("div",{className:"container_buttons"},React.createElement("button",{className:"button_yes",onClick:this.ClickButton},"Да"),React.createElement("button",{className:"button_no",onClick:this.ClickButton},"Нет")):React.createElement("div",{className:"container_button"},React.createElement("button",{onClick:this.ClickButton},"Ok")),t=React.createElement("div",{className:this.class_box,style:this.state.boxPos,onAnimationEnd:this.AnimationEnd,ref:function(e){n.msgBox=e}},React.createElement("div",{className:"upper_panel",onMouseDown:this.handleMouseDown},"Внимание"),React.createElement("div",{className:"container_text"},this.props.children),e),React.createElement("div",{className:"modal",onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp},this.state.showBox?t:null)}}]),t}();function BackImage(e){return void 0!==e.width&&void 0!==e.height?React.createElement("img",{src:e.photo_src,width:e.width,height:e.height,className:e.class_name}):React.createElement("img",{src:e.photo_src,className:e.class_name})}function AnimationText(e){return React.createElement("div",{className:e.class_name,id:e.text_id},e.children)}function AnimationHead(){return React.createElement("div",{className:"name_head"},React.createElement(AnimationText,{class_name:"name_head1 animate__animated animate__bounceInLeft animate__delay-1s animate__slow",text_id:"head_name1"},"Тренер"),React.createElement(AnimationText,{class_name:"name_head2 animate__animated animate__bounceInRight animate__delay-1s animate__slow",text_id:"head_name2"},"онлайн"))}function FormEntry(e){return React.createElement("div",{className:e.class_name,id:e.form_id},React.createElement(BackImage,{photo_src:"img/DSCN0170.JPG",class_name:"my_photo",width:"4606",height:"3456"}),React.createElement("div",{className:"my_logo"},"Copyright Бойчук Ярослав"),React.createElement(InputsBlock,{onLogon:e.onLogon,onSaveData:e.onSaveData,isSaveData:e.isSaveData}))}var InputsBlock=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={login:"",password:""},n.onChangeLogin=n.onChangeLogin.bind(n),n.onChangePassword=n.onChangePassword.bind(n),n.onClickHandler=n.onClickHandler.bind(n),n.handlerKey=n.handlerKey.bind(n),n}return _inherits(t,React.Component),_createClass(t,[{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeLogin",value:function(e){this.setState({login:e.target.value})}},{key:"onClickHandler",value:function(e){this.props.onLogon({user_name:this.state.login,password:this.state.password})}},{key:"handlerKey",value:function(e){13!==e.keyCode&&14!==e.keyCode||this.onClickHandler()}},{key:"render",value:function(){return React.createElement("div",{className:"input_block"},React.createElement("p",null,React.createElement("b",null,"Введите имя пользователя:")),React.createElement("input",{type:"text",id:"usr",value:this.state.login,onChange:this.onChangeLogin}),React.createElement("p",null,React.createElement("b",null,"Введите пароль:")),React.createElement("input",{type:"password",id:"pass",value:this.state.password,onChange:this.onChangePassword,onKeyUp:this.handlerKey}),React.createElement("input",{type:"button",id:"btn",value:"Подтвердить",onClick:this.onClickHandler}),React.createElement("p",null,React.createElement("input",{type:"checkbox",checked:this.props.isSaveData,id:"chk",onChange:this.props.onSaveData}),React.createElement("span",null,React.createElement("b",null,"Сохранить данные"))))}}]),t}();function Logon(e){return React.createElement("div",null,React.createElement(BackImage,{photo_src:"img/dumbells1.jpg",class_name:"bgstart"}),React.createElement(AnimationHead,null),React.createElement(FormEntry,{form_id:"frm0",class_name:"frame",onLogon:e.onLogon,onSaveData:e.onSaveData,isSaveData:e.isSaveData}))}var Start=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showLogon:!1,isSaveData:!0,isMsg:!1},n.user_exist=!1,n.users=null,n.onLogon=n.onLogon.bind(n),n.onStateLogon=n.onStateLogon.bind(n),n.onSaveData=n.onSaveData.bind(n),n.checkCookie=n.checkCookie.bind(n),n.CheckUser=n.CheckUser.bind(n),n.setCookie=n.setCookie.bind(n),n.getCookie=n.getCookie.bind(n),n.getConfig=n.getConfig.bind(n),n}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this.checkCookie();e?this.CheckUser(e):this.onStateLogon(!0)}},{key:"CheckUser",value:function(e){var t=this,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){t.users=JSON.parse(n.responseText);var a=t.users.usr_name.findIndex((function(t){return t==e.user_name}));if(-1!=a&&t.users.usr_pass[a]==e.password){0==t.user_exist&&t.state.isSaveData&&(t.setCookie("username",e.user_name,365),t.setCookie("password",e.password,365)),t.onStateLogon(!1);var o=t.users.usr_conf[a];null!=o&&""!=o&&t.getConfig(o,e.user_name)}else 1==t.user_exist?(document.cookie="username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="password=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",t.user_exist=!1,t.onStateLogon(!0)):t.setState({isMsg:!0})}},n.open("GET","json/users.json",!0),n.send()}},{key:"getConfig",value:function(e,t){var n,a=new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(n=JSON.parse(a.responseText),ReactDOM.render(React.createElement(TrainExercise,{complex:n,user_name:t}),document.getElementById("wrap")))},a.open("GET",e,!0),a.send()}},{key:"checkCookie",value:function(){var e={user_name:"",password:""};return e.password=this.getCookie("password"),e.user_name=this.getCookie("username"),this.user_exist=!1,""!=e.user_name&&(""!=e.password&&(this.user_exist=!0,e))}},{key:"setCookie",value:function(e,t,n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var o="expires="+a.toGMTString();document.cookie=e+"="+t+";"+o+";path=/"}},{key:"getCookie",value:function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}},{key:"onStateLogon",value:function(e){this.setState({showLogon:e})}},{key:"onLogon",value:function(e){this.CheckUser(e)}},{key:"onSaveData",value:function(e){this.setState((function(e){return{isSaveData:!e.isSaveData}}))}},{key:"render",value:function(){var e=this;return React.createElement("div",null,this.state.showLogon?React.createElement(Logon,{onLogon:this.onLogon,onSaveData:this.onSaveData,isSaveData:this.state.isSaveData}):null,this.state.isMsg?React.createElement(MessageBox,{type:"alert",effect:"zoomInDown",render:function(){e.setState({isMsg:!1})},effectOut:"zoomOutDown"},"Имя пользователя или пароль не верны"):null)}}]),t}();ReactDOM.render(React.createElement(Start,null),document.getElementById("logon"));